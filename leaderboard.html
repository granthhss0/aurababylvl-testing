<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Aurababy Leaderboard</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@800&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Poppins', sans-serif;
    font-weight: 800;
    background: linear-gradient(to bottom, #002b80, #0044cc, #0066ff);
    color: white;
    text-align: center;
    padding: 40px;
  }

  h1 {
    font-size: 2.5em;
    margin-bottom: 20px;
    color: #00ffcc;
  }

  #leaderboardContainer {
    background: rgba(0,0,0,0.35);
    padding: 30px;
    border-radius: 15px;
    max-width: 550px;
    margin: 0 auto;
    font-weight: 800;
  }

  input {
    padding: 8px;
    border-radius: 6px;
    border: none;
    margin: 5px 0;
    width: 70%;
    font-size: 1em;
  }

  button {
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    margin-left: 5px;
    font-weight: 800;
  }

  #submitBtn { background: #00ffcc; color: black; }
  #refreshBtn { background: #0072ff; color: white; }
  #backBtn { background: #ff00aa; color: white; margin-top: 15px; }

  .tabBtn {
    background: black;
    border: 2px solid #00ffcc;
    color: #00ffcc;
    padding: 8px 14px;
    margin: 10px 5px;
    border-radius: 8px;
    cursor: pointer;
  }

  .tabBtn.active {
    background: #00ffcc;
    color: black;
  }

  #submitMsg {
    margin-top: 8px;
    font-size: 0.85em;
    min-height: 20px;
  }

  #leaderboard div {
    padding: 10px;
    border-bottom: 1px solid rgba(255,255,255,0.2);
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 1.05em;
  }

  #leaderboard div:nth-child(1) { background: rgba(255,255,255,0.15); border-left: 5px solid gold; }
  #leaderboard div:nth-child(2) { background: rgba(255,255,255,0.1); border-left: 5px solid silver; }
  #leaderboard div:nth-child(3) { background: rgba(255,255,255,0.1); border-left: 5px solid #cd7f32; }
</style>
</head>

<body>

<h1>üèÜ Aurababy Leaderboard üèÜ</h1>

<div id="leaderboardContainer">

  <!-- LOGIN -->
  <div>
    <input type="text" id="usernameInput" placeholder="Enter your username">
    <button id="submitBtn">Submit</button>
  </div>
  <div id="submitMsg"></div>

  <!-- FILTER -->
  <div>
    <input type="text" id="filterInput" placeholder="Filter by username‚Ä¶">
    <button id="refreshBtn">Refresh</button>
  </div>

  <!-- TABS -->
  <div style="margin-top:15px;">
    <button class="tabBtn active" id="expTab">EXP</button>
    <button class="tabBtn" id="timeTab">TIME</button>
  </div>

  <!-- LEADERBOARD DISPLAY -->
  <div id="leaderboard" style="margin-top:20px;"></div>

  <!-- BACK BUTTON -->
  <button id="backBtn" onclick="window.location.href='index.html'">‚¨Ö Back to Level System</button>

</div>

<script>
  let leaderboard = JSON.parse(localStorage.getItem("localLeaderboard") || "[]");
  let currentTab = "exp";

  const usernameInput = document.getElementById("usernameInput");
  const submitBtn = document.getElementById("submitBtn");
  const submitMsg = document.getElementById("submitMsg");
  const leaderboardEl = document.getElementById("leaderboard");
  const filterInput = document.getElementById("filterInput");

  const expTab = document.getElementById("expTab");
  const timeTab = document.getElementById("timeTab");

  function niceNum(n){ return n.toLocaleString(); }
  function niceTime(t){ return (t || 0) + "s"; }

  function renderLeaderboard() {
    const filter = (filterInput.value || "").toLowerCase();
    let data = leaderboard.slice();

    if (filter) {
      data = data.filter(u => u.username.toLowerCase().includes(filter));
    }

    if (currentTab === "exp") {
      data.sort((a,b) => b.exp - a.exp);
    } else {
      data.sort((a,b) => b.time - a.time);
    }

    leaderboardEl.innerHTML = "";

    for (let i = 0; i < 5; i++) {
      const div = document.createElement("div");

      if (i < data.length) {
        const u = data[i];
        div.innerHTML = `
          <strong>${i+1}. ${u.username}</strong> 
          <span>
            ${niceNum(u.exp)} EXP ‚Ä¢ ${niceTime(u.time)}
          </span>`;
      } else {
        div.innerHTML = `<strong>${i+1}. ---</strong> <span>0 EXP ‚Ä¢ 0s</span>`;
      }

      leaderboardEl.appendChild(div);
    }
  }

  submitBtn.addEventListener("click", () => {
    const name = usernameInput.value.trim();
    if (!name || name.length < 3 || name.length > 20) {
      submitMsg.innerText = "Username must be 3‚Äì20 characters.";
      return;
    }

    const exp = parseInt(localStorage.getItem("exp") || "0");
    const time = parseInt(localStorage.getItem("time") || "0");

    if (exp <= 0 && time <= 0) {
      submitMsg.innerText = "You must earn EXP or TIME before submitting.";
      return;
    }

    let existing = leaderboard.find(u => u.username === name);

    if (existing) {
      existing.exp = Math.max(existing.exp, exp);
      existing.time = Math.max(existing.time, time);
    } else {
      leaderboard.push({username: name, exp: exp, time: time});
    }

    localStorage.setItem("localLeaderboard", JSON.stringify(leaderboard));

    submitMsg.innerText = `Saved! EXP: ${niceNum(exp)}, Time: ${niceTime(time)}`;
    renderLeaderboard();
  });

  document.getElementById("refreshBtn").addEventListener("click", renderLeaderboard);
  filterInput.addEventListener("input", () => setTimeout(renderLeaderboard, 200));

  expTab.onclick = () => {
    currentTab = "exp";
    expTab.classList.add("active");
    timeTab.classList.remove("active");
    renderLeaderboard();
  };

  timeTab.onclick = () => {
    currentTab = "time";
    timeTab.classList.add("active");
    expTab.classList.remove("active");
    renderLeaderboard();
  };

  renderLeaderboard();
</script>

</body>
</html>
